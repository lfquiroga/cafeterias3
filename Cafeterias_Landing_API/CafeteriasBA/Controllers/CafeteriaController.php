<?phpnamespace CafeteriasBA\Controllers;use CafeteriasBA\Core\View;use CafeteriasBA\Models\Hash;use CafeteriasBA\Models\Cafeteria as Cafeteria;use CafeteriasBA\Session\Session;//use CafeteriasBA\Session\Session;class CafeteriaController {    // TODO: LLAMAR METODOS    /**     * metodo traer todos.     */    public static function getAll() {        $cafeterias = Cafeteria::getAll();        $salida = [            'status' => 1,            'data' => $cafeterias        ];        View::render($cafeterias);    }    public static function getSugerencias()    {        $cafeterias = Cafeteria::getSugerencias();        View::render($cafeterias);    }    /**     * @param $data     * @throws \Exception     */    public static function Create($data) {        //var_dump($data);        $imgArray = explode(',',$data['stream_img']);        $imgNameArray = explode('.',$data['img_portada']);        $imgFile = base64_decode($imgArray[1]);        $uploadTime = time();        $fileName = $uploadTime.'.'.$imgNameArray[1];        $fileDirectory = $_SERVER['PHP_SELF'];        $directoryArray = explode('/',$fileDirectory);        $newDirectory = $directoryArray[1];        $saveImg = '../Cafeterias_Landing_public/img/cafeterias/'.$fileName;        file_put_contents($saveImg,$imgFile);        $data['img_portada'] = $fileName;        $cafeteria = Cafeteria::crearCafeteria($data);        $salida = [                    'status' => 1,                    'data' => $cafeteria        ];        View::render($salida);    }    public static function sugerirCafeteria($data)    {        $cafeteria = Cafeteria::sugerirCafeteria($data);        $salida = [         'status' => 1,         'data' => $cafeteria        ];        View::render($salida);    }    /**     * @param $data     * @throws \Exception     */    public static function Update($data) {        if($data['stream_img'] == null)        {            $cafeteria = Cafeteria::editarCafeteria($data);                $salida = [                            'status' => 1,                            'data' => $cafeteria                ];                View::render($salida);        }else {                       /* $imgArray = explode(',',$data['stream_img']);            $imgName = $data['old_img'];            $data['img_portada'] = $data['old_img'];            */            $imgArray = explode(',',$data['stream_img']);            if($data['old_img'] != 'no_imagen.jpg')            {                $imgName = $data['old_img'];                $data['img_portada'] = $data['old_img'];            }else            {                $uploadTime = time();                $imgName = $uploadTime.'.jpg';                $data['img_portada'] = $imgName;            }                        $imgFile = base64_decode($imgArray[1]);            $saveImg = '../Cafeterias_Landing_public/img/cafeterias/'.$imgName;            file_put_contents($saveImg,$imgFile);            $cafeteria = Cafeteria::editarCafeteria($data);            $salida = [                        'status' => 1,                        'data' => $cafeteria            ];            View::render($salida);        }        /*        $cafeteria = Cafeteria::editarCafeteria($data);        $salida = [                    'status' => 1,                    'data' => $cafeteria        ];        View::render($salida);*/    }    public static function aprobarCafeteria($data)    {        $cafeteria = Cafeteria::aprobarCafeteria($data);        $salida=[            'status' => 1,            'data' => $cafeteria        ];        View::render($salida);    }    /**     * @param $id     */    public static function getById($id) {        $cafeteria = Cafeteria::verCafeteria($id);        if ($cafeteria) {            $salida = [                        'status' => 1,                        'data' => $cafeteria            ];        } else {            $salida = [                        'status' => 0,                        'data' => 'error'            ];        }        View::render($salida);    }    /**     * @param $id     */    public static function Delete($id) {        $cafeteria = Cafeteria::eliminarCafeteria($id);        $salida = [                    'status' => 1,                    'data' => $cafeteria        ];        View::render($salida);    }    public static function getRanking() {        $cafeteriasRanking = Cafeteria::topRank();        $salida = [                    'status' => 1,                    'data' => $cafeteriasRanking        ];        View::render($cafeteriasRanking);    }    /**     * Busca cafeterias en base a parametros que le pasamos     *      * @param type $data array     */    public static function search($data) {        $cafeteriasRanking = Cafeteria::search($data);        $salida = [            'status' => 1,            'data' => $cafeteriasRanking        ];        View::render($cafeteriasRanking);    }    public static function getByEmail($email) {        $cafeteria = Cafeteria::getByEmail($email);        $cafeteriaU = Usuario::getByEmail($email);        $cafeteriaNombre = $cafeteria->getNombre();        $cafeteriaDireccion = $cafeteria->getDireccion();        $cafeteriaTelefono = $cafeteria->getTelefono();        $cafeteriaEmail = $cafeteria->getEmail();        $cafeteriaSitio_Web = $cafeteria->getSitioWeb();        $cafeteriaHorario_Apertura = $cafeteria->getHorarioApertura();        $cafeteriaHorario_Cierre = $cafeteria->getHorarioCierre();        $cafeteriaId = $cafeteria->getId();        Session::set('CafeteriaID', $cafeteriaId);        Session::set('CafeteriaN', $cafeteriaNombre);        Session::set('CafeteriaD', $cafeteriaDireccion);        Session::set('CafeteriaT', $cafeteriaTelefono);        Session::set('CafeteriaE', $cafeteriaEmail);        Session::set('CafeteriaSW', $cafeteriaSitio_Web);        Session::set('CafeteriaHA', $cafeteriaHorario_Apertura);        Session::set('CafeteriaHC', $cafeteriaHorario_Cierre);        View::render($cafeteria);    }            function verCafeteriaUsuario($id_usuario){                $cafeterias = Cafeteria::verCafeteriaPorUsuario($id_usuario);                View::render($cafeterias);    }    }